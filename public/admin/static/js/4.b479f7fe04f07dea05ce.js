webpackJsonp([4],{535:function(t,e,a){a(562);var i=a(67)(a(543),a(571),null,null);t.exports=i.exports},543:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(139),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default={data:function(){return{user:{},data:{},addCategoryName:"",activeName2:"0",commodities:[],commoditiyDetails:!1,isAdd:!0,uploadform:{token:""},ruleForm:{name:"",img:"",price:"",unit:"",putaway:""},rules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],img:[{required:!0,message:"请上传图片或填写图片地址",trigger:"blur"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],unit:[{required:!0,message:"请输入价格单位",trigger:"blur"}]}}},methods:{addCategory:function(){var t={categoryName:this.addCategoryName,details:[]};this.commodities.push(t)},removeTab:function(t){var e=t-0;this.commodities.splice(e,1),this.saveData()},handleClick:function(t,e){console.log(t),console.log(this.activeName2),this.commoditiyDetails=!1,this.isAdd=!0},showCommodity:function(t){this.ruleForm=t,this.commoditiyDetails=!0,this.isAdd=!1},addNewCommoditiy:function(){this.resetForm(),this.commoditiyDetails=!0,this.isAdd=!0},saveData:function(){function t(t){a.$message({message:t.text,type:"success"}),a.commoditiyDetails=!1}function e(t){console.log(t)}this.data.commodityList.forEach(function(t,e){t.id=""+e,t.details.forEach(function(t,a){t.id=e+"-"+a})}),this.ajax.http("put",this.host.baseUrl+"/baseinfosetting",this.data,t,e);var a=this},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;e.isAdd&&e.commodities[e.activeName2-0].details.push(e.ruleForm),e.saveData()})},resetForm:function(t){this.ruleForm={name:"",img:"",price:"",unit:"",putaway:""},this.commoditiyDetails=!1,this.isAdd=!0},handleAvatarSuccess:function(t,e,a){this.ruleForm.img=""+this.host.imgBaseUrl+t.key},beforeAvatarUpload:function(t){var e=t.size/1024/1024<1,a=this;if(e){var i={fileName:t.name};return o.default.get(a.host.baseUrl+"/uploadimg",{params:i}).then(function(t){"1"===t.data.code?a.uploadform={key:t.data.result.fileName,token:t.data.result.uploadToken}:a.$message.error("上传图片失败")}).catch(function(){a.$message.error("上传图片失败")})}return a.$message.error("上传图片大小不能超过 1MB!"),e},init:function(){function t(t){var e=t.data;a.data=e,console.log("赋值"),a.commodities=e.commodityList}function e(t){console.log(t)}this.user=JSON.parse(sessionStorage.getItem("user")),this.ajax.http("get",this.host.baseUrl+"/baseinfosetting",{userid:this.user.userid},t,e);var a=this}},mounted:function(){this.init()}}},554:function(t,e,a){e=t.exports=a(530)(),e.push([t.i,".commodity-img .avatar-uploader-icon{font-size:28px;color:#8c939d;width:150px;height:150px;line-height:150px;text-align:center;border:1px dashed #8c939d}.commodity-img .avatar{width:150px;height:150px;display:block}","",{version:3,sources:["/Users/wei/codespace/www/hy/hotel-admin/src/views/hotel/commoditySetting.vue"],names:[],mappings:"AACA,qCACE,eAAgB,AAChB,cAAe,AACf,YAAa,AACb,aAAc,AACd,kBAAmB,AACnB,kBAAmB,AACnB,yBAA2B,CAC5B,AACD,uBACE,YAAa,AACb,aAAc,AACd,aAAe,CAChB",file:"commoditySetting.vue",sourcesContent:["\n.commodity-img .avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 150px;\n  height: 150px;\n  line-height: 150px;\n  text-align: center;\n  border: 1px dashed #8c939d;\n}\n.commodity-img .avatar {\n  width: 150px;\n  height: 150px;\n  display: block;\n}\n"],sourceRoot:""}])},562:function(t,e,a){var i=a(554);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(531)("46b0ed8c",i,!0)},571:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("div",{attrs:{"label-width":"80px"}},[a("div",[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入商品类别名称"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.addCategory(e)}},model:{value:t.addCategoryName,callback:function(e){t.addCategoryName=e},expression:"addCategoryName"}}),t._v(" "),a("el-button",{staticStyle:{transform:"translateY(-1px)"},attrs:{type:"primary",disabled:0===t.addCategoryName.length},on:{click:t.addCategory}},[t._v("添加类别")])],1)]),t._v(" "),a("el-tabs",{staticStyle:{"margin-top":"30px"},attrs:{type:"card",closable:""},on:{"tab-click":t.handleClick,"tab-remove":t.removeTab},model:{value:t.activeName2,callback:function(e){t.activeName2=e},expression:"activeName2"}},[t._l(t.commodities,function(e,i){return a("el-tab-pane",{key:i,attrs:{label:e.categoryName,name:""+i}},[e.details.length>0?a("div",{staticStyle:{width:"700px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.details,"max-height":"300",border:""}},[a("el-table-column",{attrs:{prop:"name",label:"商品名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"price",label:"单价",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"unit",label:"单位",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"putaway",label:"上架状态",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.putaway?a("div",[t._v("\n\t\t\t\t\t\t\t\t是\n\t\t\t\t\t\t\t\t")]):a("div",[t._v("\n\t\t\t\t\t\t\t\t否\n\t\t\t\t\t\t\t\t")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.showCommodity(e.row)}}},[t._v("查看/修改")])]}}])})],1)],1):t._e(),t._v(" "),a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:t.addNewCommoditiy}},[t._v("添加商品")])],1)}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.commoditiyDetails,expression:"commoditiyDetails"}],staticClass:"commoditiy-details",staticStyle:{width:"700px","margin-top":"30px"}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"商品名称：",prop:"name"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"输入商品名称"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),t._v(" "),a("el-form-item",{staticClass:"commodity-img",staticStyle:{"margin-bottom":"20px"},attrs:{label:"商品图片：",prop:"img"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"//up.qbox.me/","show-file-list":!1,data:t.uploadform,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.ruleForm.img?a("img",{staticClass:"avatar",attrs:{src:t.ruleForm.img}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t._v(" "),a("el-input",{staticStyle:{position:"relative","margin-top":"20px",width:"400px"},attrs:{placeholder:"填写图片地址"},model:{value:t.ruleForm.img,callback:function(e){t.$set(t.ruleForm,"img",e)},expression:"ruleForm.img"}}),t._v(" "),a("p",[t._v("建议上传图片大小为200*200(w*h)，且图片大小上限为1M")])],1),t._v(" "),a("el-form-item",{attrs:{label:"商品单价：",prop:"price"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"输入商品单价"},model:{value:t.ruleForm.price,callback:function(e){t.$set(t.ruleForm,"price",e)},expression:"ruleForm.price"}}),t._v(" / 元\n\t\t\t\t")],1),t._v(" "),a("el-form-item",{attrs:{label:"价格单位：",prop:"unit"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"输入价格单位"},model:{value:t.ruleForm.unit,callback:function(e){t.$set(t.ruleForm,"unit",e)},expression:"ruleForm.unit"}}),t._v("\n\t\t\t\t\t（件、个、瓶等等）\n\t\t\t\t")],1),t._v(" "),a("el-form-item",{attrs:{label:"是否上架：",prop:"putaway"}},[a("el-switch",{model:{value:t.ruleForm.putaway,callback:function(e){t.$set(t.ruleForm,"putaway",e)},expression:"ruleForm.putaway"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("保存")]),t._v(" "),a("el-button",{on:{click:t.resetForm}},[t._v("取消")])],1)],1)],1)],2)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=4.b479f7fe04f07dea05ce.js.map